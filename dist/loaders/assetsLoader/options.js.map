{"version":3,"file":"options.js","names":["_schemaUtils","require","optionsSchema","exports","type","properties","platform","scalableAssetExtensions","scalableAssetResolutions","inline","publicPath","remote","required","enabled","assetPath","instanceOf","pattern","getOptions","loaderContext","options","validate","name"],"sources":["../../../src/loaders/assetsLoader/options.ts"],"sourcesContent":["import type { LoaderContext } from '@rspack/core';\nimport { validate } from 'schema-utils';\n\nexport interface AssetLoaderRemoteOptions {\n  enabled: boolean;\n  assetPath?: (args: {\n    resourcePath: string;\n    resourceFilename: string;\n    resourceDirname: string;\n    resourceExtensionType: string;\n  }) => string;\n  publicPath: string;\n}\n\n// Note: publicPath could be obtained from webpack config in the future\nexport interface AssetLoaderOptions {\n  platform?: string;\n  scalableAssetExtensions?: string[];\n  scalableAssetResolutions?: string[];\n  inline?: boolean;\n  publicPath?: string;\n  remote?: AssetLoaderRemoteOptions;\n}\n\nexport interface AssetLoaderContext extends LoaderContext<AssetLoaderOptions> {}\n\ntype Schema = Parameters<typeof validate>[0];\n\nexport const optionsSchema: Schema = {\n  type: 'object',\n  properties: {\n    platform: {\n      type: 'string',\n    },\n    scalableAssetExtensions: {\n      type: 'array',\n    },\n    scalableAssetResolutions: {\n      type: 'array',\n    },\n    inline: { type: 'boolean' },\n    publicPath: { type: 'string' },\n    remote: {\n      type: 'object',\n      required: ['enabled', 'publicPath'],\n      properties: {\n        enabled: { type: 'boolean' },\n        assetPath: { instanceOf: 'Function' },\n        publicPath: { type: 'string', pattern: '^https?://' },\n      },\n    },\n  },\n};\n\nexport function getOptions(\n  loaderContext: LoaderContext<AssetLoaderOptions>\n): AssetLoaderOptions {\n  const options = loaderContext.getOptions() || {};\n\n  validate(optionsSchema, options, { name: 'repackAssetsLoader' });\n\n  return options;\n}\n"],"mappings":";;;;;;;AACA,IAAAA,YAAA,GAAAC,OAAA;AAaA;;AAcO,MAAMC,aAAqB,GAAAC,OAAA,CAAAD,aAAA,GAAG;EACnCE,IAAI,EAAE,QAAQ;EACdC,UAAU,EAAE;IACVC,QAAQ,EAAE;MACRF,IAAI,EAAE;IACR,CAAC;IACDG,uBAAuB,EAAE;MACvBH,IAAI,EAAE;IACR,CAAC;IACDI,wBAAwB,EAAE;MACxBJ,IAAI,EAAE;IACR,CAAC;IACDK,MAAM,EAAE;MAAEL,IAAI,EAAE;IAAU,CAAC;IAC3BM,UAAU,EAAE;MAAEN,IAAI,EAAE;IAAS,CAAC;IAC9BO,MAAM,EAAE;MACNP,IAAI,EAAE,QAAQ;MACdQ,QAAQ,EAAE,CAAC,SAAS,EAAE,YAAY,CAAC;MACnCP,UAAU,EAAE;QACVQ,OAAO,EAAE;UAAET,IAAI,EAAE;QAAU,CAAC;QAC5BU,SAAS,EAAE;UAAEC,UAAU,EAAE;QAAW,CAAC;QACrCL,UAAU,EAAE;UAAEN,IAAI,EAAE,QAAQ;UAAEY,OAAO,EAAE;QAAa;MACtD;IACF;EACF;AACF,CAAC;AAEM,SAASC,UAAUA,CACxBC,aAAgD,EAC5B;EACpB,MAAMC,OAAO,GAAGD,aAAa,CAACD,UAAU,CAAC,CAAC,IAAI,CAAC,CAAC;EAEhD,IAAAG,qBAAQ,EAAClB,aAAa,EAAEiB,OAAO,EAAE;IAAEE,IAAI,EAAE;EAAqB,CAAC,CAAC;EAEhE,OAAOF,OAAO;AAChB","ignoreList":[]}