{"version":3,"file":"AuxiliaryAssetsCopyProcessor.js","names":["_nodeFs","_interopRequireDefault","require","_nodePath","e","__esModule","default","AuxiliaryAssetsCopyProcessor","queue","constructor","config","filesystem","fs","copyAsset","from","to","logger","debug","promises","mkdir","path","dirname","recursive","copyFile","enqueueAsset","asset","outputPath","assetsDest","push","join","execute","map","work","exports"],"sources":["../../../src/plugins/utils/AuxiliaryAssetsCopyProcessor.ts"],"sourcesContent":["import fs from 'node:fs';\nimport path from 'node:path';\n\nexport class AuxiliaryAssetsCopyProcessor {\n  queue: Array<() => Promise<void>> = [];\n\n  constructor(\n    public readonly config: {\n      platform: string;\n      outputPath: string;\n      assetsDest: string;\n      logger: {\n        debug: (...args: string[]) => void;\n      };\n    },\n    private filesystem = fs\n  ) {}\n\n  private async copyAsset(from: string, to: string) {\n    this.config.logger.debug('Copying asset:', from, 'to:', to);\n    await this.filesystem.promises.mkdir(path.dirname(to), { recursive: true });\n    await this.filesystem.promises.copyFile(from, to);\n  }\n\n  enqueueAsset(asset: string) {\n    const { outputPath, assetsDest } = this.config;\n\n    this.queue.push(() =>\n      this.copyAsset(path.join(outputPath, asset), path.join(assetsDest, asset))\n    );\n  }\n\n  execute() {\n    const queue = this.queue;\n    this.queue = [];\n    return queue.map((work) => work());\n  }\n}\n"],"mappings":";;;;;;AAAA,IAAAA,OAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AAA6B,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEtB,MAAMG,4BAA4B,CAAC;EACxCC,KAAK,GAA+B,EAAE;EAEtCC,WAAWA,CACOC,MAOf,EACOC,UAAU,GAAGC,eAAE,EACvB;IAAA,KATgBF,MAOf,GAPeA,MAOf;IAAA,KACOC,UAAU,GAAVA,UAAU;EACjB;EAEH,MAAcE,SAASA,CAACC,IAAY,EAAEC,EAAU,EAAE;IAChD,IAAI,CAACL,MAAM,CAACM,MAAM,CAACC,KAAK,CAAC,gBAAgB,EAAEH,IAAI,EAAE,KAAK,EAAEC,EAAE,CAAC;IAC3D,MAAM,IAAI,CAACJ,UAAU,CAACO,QAAQ,CAACC,KAAK,CAACC,iBAAI,CAACC,OAAO,CAACN,EAAE,CAAC,EAAE;MAAEO,SAAS,EAAE;IAAK,CAAC,CAAC;IAC3E,MAAM,IAAI,CAACX,UAAU,CAACO,QAAQ,CAACK,QAAQ,CAACT,IAAI,EAAEC,EAAE,CAAC;EACnD;EAEAS,YAAYA,CAACC,KAAa,EAAE;IAC1B,MAAM;MAAEC,UAAU;MAAEC;IAAW,CAAC,GAAG,IAAI,CAACjB,MAAM;IAE9C,IAAI,CAACF,KAAK,CAACoB,IAAI,CAAC,MACd,IAAI,CAACf,SAAS,CAACO,iBAAI,CAACS,IAAI,CAACH,UAAU,EAAED,KAAK,CAAC,EAAEL,iBAAI,CAACS,IAAI,CAACF,UAAU,EAAEF,KAAK,CAAC,CAC3E,CAAC;EACH;EAEAK,OAAOA,CAAA,EAAG;IACR,MAAMtB,KAAK,GAAG,IAAI,CAACA,KAAK;IACxB,IAAI,CAACA,KAAK,GAAG,EAAE;IACf,OAAOA,KAAK,CAACuB,GAAG,CAAEC,IAAI,IAAKA,IAAI,CAAC,CAAC,CAAC;EACpC;AACF;AAACC,OAAA,CAAA1B,4BAAA,GAAAA,4BAAA","ignoreList":[]}