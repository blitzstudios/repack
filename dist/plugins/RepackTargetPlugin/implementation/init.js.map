{"version":3,"file":"init.js","names":["$globalObject$","$hmrEnabled$","module","exports","repackRuntime","loadScript","loadHotUpdate","shared","__repack__","__webpack_require__","repack","scriptManager","undefined","name","caller","done","referenceUrl","then","catch","reason","console","error","type","target","src","url","fetch","response","ok","statusText","text","script","unstable_evaluateScript","eval"],"sources":["../../../../src/plugins/RepackTargetPlugin/implementation/init.ts"],"sourcesContent":["const $globalObject$ = {} as Record<string, any>;\nconst $hmrEnabled$ = false;\n\nmodule.exports = function () {\n  var repackRuntime: RepackRuntime = {\n    loadScript,\n    loadHotUpdate,\n    shared: ($globalObject$.__repack__ && $globalObject$.__repack__.shared) ||\n      (__webpack_require__.repack && __webpack_require__.repack.shared) || {\n        scriptManager: undefined,\n      },\n  };\n\n  __webpack_require__.repack = $globalObject$.__repack__ = repackRuntime;\n\n  function loadScript(\n    name: string,\n    caller: string | undefined,\n    done: (event?: LoadScriptEvent) => void,\n    referenceUrl: string\n  ) {\n    if (repackRuntime.shared.scriptManager) {\n      repackRuntime.shared.scriptManager\n        .loadScript(name, caller, __webpack_require__, referenceUrl)\n        .then(function () {\n          done();\n          return;\n        })\n        .catch(function (reason) {\n          console.error('[RepackRuntime] Loading script failed:', reason);\n          done({ type: 'exec', target: { src: name } });\n        });\n    } else {\n      console.error('[RepackRuntime] Script manager was not provided');\n      done({ type: 'exec', target: { src: name } });\n    }\n  }\n\n  function loadHotUpdate(url: string, done: (event?: LoadScriptEvent) => void) {\n    if (!$hmrEnabled$) {\n      console.error('[RepackRuntime] Loading HMR update chunks is disabled');\n      done({ type: 'disabled', target: { src: url } });\n      return;\n    }\n\n    (\n      fetch(url).then(function (response) {\n        if (!response.ok) {\n          console.error(\n            '[RepackRuntime] Loading HMR update failed:',\n            response.statusText\n          );\n          done({ type: response.statusText, target: { src: url } });\n          return;\n        }\n\n        return response.text();\n      }) as Promise<string | undefined>\n    )\n      .then(function (script?: string) {\n        if (script) {\n          if (repackRuntime.shared.scriptManager) {\n            repackRuntime.shared.scriptManager.unstable_evaluateScript(\n              script,\n              url\n            );\n          } else {\n            eval(script);\n          }\n        }\n\n        return;\n      })\n      .catch(function (reason) {\n        console.error(\n          '[RepackRuntime] Loading HMR update chunk failed:',\n          reason\n        );\n        done({ type: 'exec', target: { src: url } });\n      });\n  }\n};\n"],"mappings":"AAAA,MAAMA,cAAc,GAAG,CAAC,CAAwB;AAChD,MAAMC,YAAY,GAAG,KAAK;AAE1BC,MAAM,CAACC,OAAO,GAAG,YAAY;EAC3B,IAAIC,aAA4B,GAAG;IACjCC,UAAU;IACVC,aAAa;IACbC,MAAM,EAAGP,cAAc,CAACQ,UAAU,IAAIR,cAAc,CAACQ,UAAU,CAACD,MAAM,IACnEE,mBAAmB,CAACC,MAAM,IAAID,mBAAmB,CAACC,MAAM,CAACH,MAAO,IAAI;MACnEI,aAAa,EAAEC;IACjB;EACJ,CAAC;EAEDH,mBAAmB,CAACC,MAAM,GAAGV,cAAc,CAACQ,UAAU,GAAGJ,aAAa;EAEtE,SAASC,UAAUA,CACjBQ,IAAY,EACZC,MAA0B,EAC1BC,IAAuC,EACvCC,YAAoB,EACpB;IACA,IAAIZ,aAAa,CAACG,MAAM,CAACI,aAAa,EAAE;MACtCP,aAAa,CAACG,MAAM,CAACI,aAAa,CAC/BN,UAAU,CAACQ,IAAI,EAAEC,MAAM,EAAEL,mBAAmB,EAAEO,YAAY,CAAC,CAC3DC,IAAI,CAAC,YAAY;QAChBF,IAAI,CAAC,CAAC;QACN;MACF,CAAC,CAAC,CACDG,KAAK,CAAC,UAAUC,MAAM,EAAE;QACvBC,OAAO,CAACC,KAAK,CAAC,wCAAwC,EAAEF,MAAM,CAAC;QAC/DJ,IAAI,CAAC;UAAEO,IAAI,EAAE,MAAM;UAAEC,MAAM,EAAE;YAAEC,GAAG,EAAEX;UAAK;QAAE,CAAC,CAAC;MAC/C,CAAC,CAAC;IACN,CAAC,MAAM;MACLO,OAAO,CAACC,KAAK,CAAC,iDAAiD,CAAC;MAChEN,IAAI,CAAC;QAAEO,IAAI,EAAE,MAAM;QAAEC,MAAM,EAAE;UAAEC,GAAG,EAAEX;QAAK;MAAE,CAAC,CAAC;IAC/C;EACF;EAEA,SAASP,aAAaA,CAACmB,GAAW,EAAEV,IAAuC,EAAE;IAC3E,IAAI,CAACd,YAAY,EAAE;MACjBmB,OAAO,CAACC,KAAK,CAAC,uDAAuD,CAAC;MACtEN,IAAI,CAAC;QAAEO,IAAI,EAAE,UAAU;QAAEC,MAAM,EAAE;UAAEC,GAAG,EAAEC;QAAI;MAAE,CAAC,CAAC;MAChD;IACF;IAGEC,KAAK,CAACD,GAAG,CAAC,CAACR,IAAI,CAAC,UAAUU,QAAQ,EAAE;MAClC,IAAI,CAACA,QAAQ,CAACC,EAAE,EAAE;QAChBR,OAAO,CAACC,KAAK,CACX,4CAA4C,EAC5CM,QAAQ,CAACE,UACX,CAAC;QACDd,IAAI,CAAC;UAAEO,IAAI,EAAEK,QAAQ,CAACE,UAAU;UAAEN,MAAM,EAAE;YAAEC,GAAG,EAAEC;UAAI;QAAE,CAAC,CAAC;QACzD;MACF;MAEA,OAAOE,QAAQ,CAACG,IAAI,CAAC,CAAC;IACxB,CAAC,CAAC,CAEDb,IAAI,CAAC,UAAUc,MAAe,EAAE;MAC/B,IAAIA,MAAM,EAAE;QACV,IAAI3B,aAAa,CAACG,MAAM,CAACI,aAAa,EAAE;UACtCP,aAAa,CAACG,MAAM,CAACI,aAAa,CAACqB,uBAAuB,CACxDD,MAAM,EACNN,GACF,CAAC;QACH,CAAC,MAAM;UACLQ,IAAI,CAACF,MAAM,CAAC;QACd;MACF;MAEA;IACF,CAAC,CAAC,CACDb,KAAK,CAAC,UAAUC,MAAM,EAAE;MACvBC,OAAO,CAACC,KAAK,CACX,kDAAkD,EAClDF,MACF,CAAC;MACDJ,IAAI,CAAC;QAAEO,IAAI,EAAE,MAAM;QAAEC,MAAM,EAAE;UAAEC,GAAG,EAAEC;QAAI;MAAE,CAAC,CAAC;IAC9C,CAAC,CAAC;EACN;AACF,CAAC","ignoreList":[]}