{"version":3,"file":"LoadScriptRuntimeModule.js","names":["makeLoadScriptRuntimeModule","compiler","moduleConfig","Template","webpack","RuntimeGlobals","RuntimeModule","LoadScriptRuntimeModule","constructor","config","STAGE_BASIC","generate","asString","getFunctionContent","require","replaceAll","chunkId","toString","hmrEnabled","loadScript","exports"],"sources":["../../../src/plugins/RepackTargetPlugin/LoadScriptRuntimeModule.ts"],"sourcesContent":["import type {\n  Compiler,\n  RuntimeModule as RuntimeModuleType,\n} from '@rspack/core';\n\ninterface LoadScriptRuntimeModuleConfig {\n  chunkId: string | number | undefined;\n  hmrEnabled: boolean;\n}\n\n// runtime module class is generated dynamically based on the compiler instance\n// this way it's compatible with both webpack and rspack\nexport const makeLoadScriptRuntimeModule = (\n  compiler: Compiler,\n  moduleConfig: LoadScriptRuntimeModuleConfig\n): RuntimeModuleType => {\n  const Template = compiler.webpack.Template;\n  const RuntimeGlobals = compiler.webpack.RuntimeGlobals;\n  const RuntimeModule = compiler.webpack.RuntimeModule;\n\n  const LoadScriptRuntimeModule = class extends RuntimeModule {\n    constructor(private config: LoadScriptRuntimeModuleConfig) {\n      super('repack/load script', RuntimeModule.STAGE_BASIC);\n    }\n\n    generate() {\n      return Template.asString([\n        Template.getFunctionContent(require('./implementation/loadScript.js'))\n          .replaceAll('$caller$', `'${this.config.chunkId?.toString()}'`)\n          .replaceAll('$hmrEnabled$', `${this.config.hmrEnabled}`)\n          .replaceAll('$loadScript$', RuntimeGlobals.loadScript),\n      ]);\n    }\n  };\n\n  return new LoadScriptRuntimeModule(moduleConfig);\n};\n"],"mappings":";;;;;;AAUA;AACA;AACO,MAAMA,2BAA2B,GAAGA,CACzCC,QAAkB,EAClBC,YAA2C,KACrB;EACtB,MAAMC,QAAQ,GAAGF,QAAQ,CAACG,OAAO,CAACD,QAAQ;EAC1C,MAAME,cAAc,GAAGJ,QAAQ,CAACG,OAAO,CAACC,cAAc;EACtD,MAAMC,aAAa,GAAGL,QAAQ,CAACG,OAAO,CAACE,aAAa;EAEpD,MAAMC,uBAAuB,GAAG,cAAcD,aAAa,CAAC;IAC1DE,WAAWA,CAASC,MAAqC,EAAE;MACzD,KAAK,CAAC,oBAAoB,EAAEH,aAAa,CAACI,WAAW,CAAC;MAAC,KADrCD,MAAqC,GAArCA,MAAqC;IAEzD;IAEAE,QAAQA,CAAA,EAAG;MACT,OAAOR,QAAQ,CAACS,QAAQ,CAAC,CACvBT,QAAQ,CAACU,kBAAkB,CAACC,OAAO,CAAC,gCAAgC,CAAC,CAAC,CACnEC,UAAU,CAAC,UAAU,EAAE,IAAI,IAAI,CAACN,MAAM,CAACO,OAAO,EAAEC,QAAQ,CAAC,CAAC,GAAG,CAAC,CAC9DF,UAAU,CAAC,cAAc,EAAE,GAAG,IAAI,CAACN,MAAM,CAACS,UAAU,EAAE,CAAC,CACvDH,UAAU,CAAC,cAAc,EAAEV,cAAc,CAACc,UAAU,CAAC,CACzD,CAAC;IACJ;EACF,CAAC;EAED,OAAO,IAAIZ,uBAAuB,CAACL,YAAY,CAAC;AAClD,CAAC;AAACkB,OAAA,CAAApB,2BAAA,GAAAA,2BAAA","ignoreList":[]}