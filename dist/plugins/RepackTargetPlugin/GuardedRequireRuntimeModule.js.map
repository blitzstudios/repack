{"version":3,"file":"GuardedRequireRuntimeModule.js","names":["makeGuardedRequireRuntimeModule","compiler","moduleConfig","Template","webpack","RuntimeModule","GuardedRequireRuntimeModule","constructor","config","STAGE_NORMAL","generate","asString","getFunctionContent","require","replaceAll","globalObject","exports"],"sources":["../../../src/plugins/RepackTargetPlugin/GuardedRequireRuntimeModule.ts"],"sourcesContent":["import type {\n  Compiler,\n  RuntimeModule as RuntimeModuleType,\n} from '@rspack/core';\n\ninterface GuardedRequireRuntimeModuleConfig {\n  globalObject: string;\n}\n\n// runtime module class is generated dynamically based on the compiler instance\n// this way it's compatible with both webpack and rspack\nexport const makeGuardedRequireRuntimeModule = (\n  compiler: Compiler,\n  moduleConfig: GuardedRequireRuntimeModuleConfig\n): RuntimeModuleType => {\n  const Template = compiler.webpack.Template;\n  const RuntimeModule = compiler.webpack.RuntimeModule;\n\n  const GuardedRequireRuntimeModule = class extends RuntimeModule {\n    constructor(private config: GuardedRequireRuntimeModuleConfig) {\n      super('repack/guarded require', RuntimeModule.STAGE_NORMAL);\n    }\n\n    generate() {\n      return Template.asString([\n        Template.getFunctionContent(\n          require('./implementation/guardedRequire.js')\n        ).replaceAll('$globalObject$', this.config.globalObject),\n      ]);\n    }\n  };\n\n  return new GuardedRequireRuntimeModule(moduleConfig);\n};\n"],"mappings":";;;;;;AASA;AACA;AACO,MAAMA,+BAA+B,GAAGA,CAC7CC,QAAkB,EAClBC,YAA+C,KACzB;EACtB,MAAMC,QAAQ,GAAGF,QAAQ,CAACG,OAAO,CAACD,QAAQ;EAC1C,MAAME,aAAa,GAAGJ,QAAQ,CAACG,OAAO,CAACC,aAAa;EAEpD,MAAMC,2BAA2B,GAAG,cAAcD,aAAa,CAAC;IAC9DE,WAAWA,CAASC,MAAyC,EAAE;MAC7D,KAAK,CAAC,wBAAwB,EAAEH,aAAa,CAACI,YAAY,CAAC;MAAC,KAD1CD,MAAyC,GAAzCA,MAAyC;IAE7D;IAEAE,QAAQA,CAAA,EAAG;MACT,OAAOP,QAAQ,CAACQ,QAAQ,CAAC,CACvBR,QAAQ,CAACS,kBAAkB,CACzBC,OAAO,CAAC,oCAAoC,CAC9C,CAAC,CAACC,UAAU,CAAC,gBAAgB,EAAE,IAAI,CAACN,MAAM,CAACO,YAAY,CAAC,CACzD,CAAC;IACJ;EACF,CAAC;EAED,OAAO,IAAIT,2BAA2B,CAACJ,YAAY,CAAC;AACtD,CAAC;AAACc,OAAA,CAAAhB,+BAAA,GAAAA,+BAAA","ignoreList":[]}