{"version":3,"file":"devtoolsPlugin.js","names":["openStackFrameInEditorMiddleware","openURLMiddleware","fastifyPlugin","devtoolsPlugin","instance","options","use","watchFolders","rootDir","route","method","url","handler","_request","reply","wss","messageServer","broadcast","send","name","dependencies"],"sources":["../../../src/plugins/devtools/devtoolsPlugin.ts"],"sourcesContent":["import {\n  openStackFrameInEditorMiddleware,\n  openURLMiddleware,\n} from '@react-native-community/cli-server-api';\nimport type { FastifyInstance } from 'fastify';\nimport fastifyPlugin from 'fastify-plugin';\nimport type { Server } from '../../types';\n\nasync function devtoolsPlugin(\n  instance: FastifyInstance,\n  { options }: { options: Server.Options }\n) {\n  instance.use('/open-url', openURLMiddleware);\n\n  instance.use(\n    '/open-stack-frame',\n    openStackFrameInEditorMiddleware({\n      watchFolders: [options.rootDir],\n    })\n  );\n\n  instance.route({\n    method: ['GET', 'POST', 'PUT'],\n    url: '/reload',\n    handler: (_request, reply) => {\n      instance.wss.messageServer.broadcast('reload');\n      reply.send('OK');\n    },\n  });\n}\n\nexport default fastifyPlugin(devtoolsPlugin, {\n  name: 'devtools-plugin',\n  dependencies: ['wss-plugin'],\n});\n"],"mappings":"AAAA,SACEA,gCAAgC,EAChCC,iBAAiB,QACZ,wCAAwC;AAE/C,OAAOC,aAAa,MAAM,gBAAgB;AAG1C,eAAeC,cAAcA,CAC3BC,QAAyB,EACzB;EAAEC;AAAqC,CAAC,EACxC;EACAD,QAAQ,CAACE,GAAG,CAAC,WAAW,EAAEL,iBAAiB,CAAC;EAE5CG,QAAQ,CAACE,GAAG,CACV,mBAAmB,EACnBN,gCAAgC,CAAC;IAC/BO,YAAY,EAAE,CAACF,OAAO,CAACG,OAAO;EAChC,CAAC,CACH,CAAC;EAEDJ,QAAQ,CAACK,KAAK,CAAC;IACbC,MAAM,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,KAAK,CAAC;IAC9BC,GAAG,EAAE,SAAS;IACdC,OAAO,EAAEA,CAACC,QAAQ,EAAEC,KAAK,KAAK;MAC5BV,QAAQ,CAACW,GAAG,CAACC,aAAa,CAACC,SAAS,CAAC,QAAQ,CAAC;MAC9CH,KAAK,CAACI,IAAI,CAAC,IAAI,CAAC;IAClB;EACF,CAAC,CAAC;AACJ;AAEA,eAAehB,aAAa,CAACC,cAAc,EAAE;EAC3CgB,IAAI,EAAE,iBAAiB;EACvBC,YAAY,EAAE,CAAC,YAAY;AAC7B,CAAC,CAAC","ignoreList":[]}