{"version":3,"file":"getCommandConfig.js","names":["_env","require","_consts","isExperimentalCacheEnabled","process","env","EXPERIMENTAL_CACHE_ENV_KEY","getCacheConfig","bundler","cache","experiments","type","getStartCommandDefaults","mode","devServer","host","DEFAULT_HOSTNAME","port","DEFAULT_PORT","hot","server","output","publicPath","getBundleCommandDefaults","optimization","minimize","getCommandConfig","command","Error"],"sources":["../../../../src/commands/common/config/getCommandConfig.ts"],"sourcesContent":["import { EXPERIMENTAL_CACHE_ENV_KEY } from '../../../env.js';\nimport { DEFAULT_HOSTNAME, DEFAULT_PORT } from '../../consts.js';\n\nfunction isExperimentalCacheEnabled() {\n  return (\n    process.env[EXPERIMENTAL_CACHE_ENV_KEY] === 'true' ||\n    process.env[EXPERIMENTAL_CACHE_ENV_KEY] === '1'\n  );\n}\n\nfunction getCacheConfig(bundler: 'rspack' | 'webpack') {\n  if (isExperimentalCacheEnabled()) {\n    if (bundler === 'rspack') {\n      return {\n        cache: true,\n        experiments: { cache: { type: 'persistent' } },\n      };\n    }\n    return { cache: { type: 'filesystem' } };\n  }\n  return {};\n}\n\nfunction getStartCommandDefaults(bundler: 'rspack' | 'webpack') {\n  return {\n    ...getCacheConfig(bundler),\n    mode: 'development',\n    devServer: {\n      host: DEFAULT_HOSTNAME,\n      port: DEFAULT_PORT,\n      hot: true,\n      server: 'http',\n    },\n    output: {\n      publicPath: 'DEV_SERVER_PUBLIC_PATH',\n    },\n  };\n}\n\nfunction getBundleCommandDefaults() {\n  return {\n    mode: 'production',\n    devServer: false,\n    optimization: {\n      minimize: true,\n    },\n  };\n}\n\nexport function getCommandConfig(\n  command: 'start' | 'bundle',\n  bundler: 'rspack' | 'webpack'\n) {\n  if (command === 'start') {\n    return getStartCommandDefaults(bundler);\n  }\n\n  if (command === 'bundle') {\n    return getBundleCommandDefaults();\n  }\n\n  throw new Error(`Unknown command: ${command}`);\n}\n"],"mappings":";;;;;;AAAA,IAAAA,IAAA,GAAAC,OAAA;AACA,IAAAC,OAAA,GAAAD,OAAA;AAEA,SAASE,0BAA0BA,CAAA,EAAG;EACpC,OACEC,OAAO,CAACC,GAAG,CAACC,+BAA0B,CAAC,KAAK,MAAM,IAClDF,OAAO,CAACC,GAAG,CAACC,+BAA0B,CAAC,KAAK,GAAG;AAEnD;AAEA,SAASC,cAAcA,CAACC,OAA6B,EAAE;EACrD,IAAIL,0BAA0B,CAAC,CAAC,EAAE;IAChC,IAAIK,OAAO,KAAK,QAAQ,EAAE;MACxB,OAAO;QACLC,KAAK,EAAE,IAAI;QACXC,WAAW,EAAE;UAAED,KAAK,EAAE;YAAEE,IAAI,EAAE;UAAa;QAAE;MAC/C,CAAC;IACH;IACA,OAAO;MAAEF,KAAK,EAAE;QAAEE,IAAI,EAAE;MAAa;IAAE,CAAC;EAC1C;EACA,OAAO,CAAC,CAAC;AACX;AAEA,SAASC,uBAAuBA,CAACJ,OAA6B,EAAE;EAC9D,OAAO;IACL,GAAGD,cAAc,CAACC,OAAO,CAAC;IAC1BK,IAAI,EAAE,aAAa;IACnBC,SAAS,EAAE;MACTC,IAAI,EAAEC,wBAAgB;MACtBC,IAAI,EAAEC,oBAAY;MAClBC,GAAG,EAAE,IAAI;MACTC,MAAM,EAAE;IACV,CAAC;IACDC,MAAM,EAAE;MACNC,UAAU,EAAE;IACd;EACF,CAAC;AACH;AAEA,SAASC,wBAAwBA,CAAA,EAAG;EAClC,OAAO;IACLV,IAAI,EAAE,YAAY;IAClBC,SAAS,EAAE,KAAK;IAChBU,YAAY,EAAE;MACZC,QAAQ,EAAE;IACZ;EACF,CAAC;AACH;AAEO,SAASC,gBAAgBA,CAC9BC,OAA2B,EAC3BnB,OAA6B,EAC7B;EACA,IAAImB,OAAO,KAAK,OAAO,EAAE;IACvB,OAAOf,uBAAuB,CAACJ,OAAO,CAAC;EACzC;EAEA,IAAImB,OAAO,KAAK,QAAQ,EAAE;IACxB,OAAOJ,wBAAwB,CAAC,CAAC;EACnC;EAEA,MAAM,IAAIK,KAAK,CAAC,oBAAoBD,OAAO,EAAE,CAAC;AAChD","ignoreList":[]}